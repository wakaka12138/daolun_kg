<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Open3 - Documentation for Ruby 3.3</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    
<!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    <li ><a href="#method-c-capture2">::capture2</a>
    <li ><a href="#method-c-capture2e">::capture2e</a>
    <li ><a href="#method-c-capture3">::capture3</a>
    <li ><a href="#method-c-pipeline">::pipeline</a>
    <li ><a href="#method-c-pipeline_r">::pipeline_r</a>
    <li ><a href="#method-c-pipeline_rw">::pipeline_rw</a>
    <li ><a href="#method-c-pipeline_start">::pipeline_start</a>
    <li ><a href="#method-c-pipeline_w">::pipeline_w</a>
    <li ><a href="#method-c-popen2">::popen2</a>
    <li ><a href="#method-c-popen2e">::popen2e</a>
    <li ><a href="#method-c-popen3">::popen3</a>
    <li ><a href="#method-i-capture2">#capture2</a>
    <li ><a href="#method-i-capture2e">#capture2e</a>
    <li ><a href="#method-i-capture3">#capture3</a>
    <li ><a href="#method-i-pipeline">#pipeline</a>
    <li ><a href="#method-i-pipeline_r">#pipeline_r</a>
    <li ><a href="#method-i-pipeline_rw">#pipeline_rw</a>
    <li ><a href="#method-i-pipeline_start">#pipeline_start</a>
    <li ><a href="#method-i-pipeline_w">#pipeline_w</a>
    <li ><a href="#method-i-popen2">#popen2</a>
    <li ><a href="#method-i-popen2e">#popen2e</a>
    <li ><a href="#method-i-popen3">#popen3</a>
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Open3">
  <h1 id="module-Open3" class="module">
    module Open3
  </h1>

  <section class="description">
    
<p>Module Open3 supports creating child processes with access to their $stdin, $stdout, and $stderr streams.</p>

<h2 id="module-Open3-label-What-27s+Here">What’s Here<span><a href="#module-Open3-label-What-27s+Here">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Each of these methods executes a given command in a new process or subshell, or multiple commands in new processes and/or subshells:</p>
<ul><li>
<p>Each of these methods executes a single command in a process or subshell, accepts a string for input to $stdin, and returns string output from $stdout, $stderr, or both:</p>
<ul><li>
<p><a href="Open3.html#method-c-capture2"><code>Open3.capture2</code></a>: Executes the command; returns the string from $stdout.</p>
</li><li>
<p><a href="Open3.html#method-c-capture2e"><code>Open3.capture2e</code></a>: Executes the command; returns the string from merged $stdout and $stderr.</p>
</li><li>
<p><a href="Open3.html#method-c-capture3"><code>Open3.capture3</code></a>: Executes the command; returns strings from $stdout and $stderr.</p>
</li></ul>
</li><li>
<p>Each of these methods executes a single command in a process or subshell, and returns pipes for $stdin, $stdout, and/or $stderr:</p>
<ul><li>
<p><a href="Open3.html#method-c-popen2"><code>Open3.popen2</code></a>: Executes the command; returns pipes for $stdin and $stdout.</p>
</li><li>
<p><a href="Open3.html#method-c-popen2e"><code>Open3.popen2e</code></a>: Executes the command; returns pipes for $stdin and merged $stdout and $stderr.</p>
</li><li>
<p><a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>: Executes the command; returns pipes for $stdin, $stdout, and $stderr.</p>
</li></ul>
</li><li>
<p>Each of these methods executes one or more commands in processes and/or subshells, returns pipes for the first $stdin, the last $stdout, or both:</p>
<ul><li>
<p><a href="Open3.html#method-c-pipeline_r"><code>Open3.pipeline_r</code></a>: Returns a pipe for the last $stdout.</p>
</li><li>
<p><a href="Open3.html#method-c-pipeline_rw"><code>Open3.pipeline_rw</code></a>: Returns pipes for the first $stdin and the last $stdout.</p>
</li><li>
<p><a href="Open3.html#method-c-pipeline_w"><code>Open3.pipeline_w</code></a>: Returns a pipe for the first $stdin.</p>
</li><li>
<p><a href="Open3.html#method-c-pipeline_start"><code>Open3.pipeline_start</code></a>: Does not wait for processes to complete.</p>
</li><li>
<p><a href="Open3.html#method-c-pipeline"><code>Open3.pipeline</code></a>: Waits for processes to complete.</p>
</li></ul>
</li></ul>

<p>Each of the methods above accepts:</p>
<ul><li>
<p>An optional hash of environment variable names and values; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>
</li><li>
<p>A required string argument that is a <code>command_line</code> or <code>exe_path</code>; see <a href="Process.html#module-Process-label-Argument+command_line+or+exe_path">Argument command_line or exe_path</a>.</p>
</li><li>
<p>An optional hash of execution options; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>
</li></ul>

  </section>

  <section id="5Buntitled-5D" class="documentation-section">


    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
        <dt id="VERSION">VERSION
        <dd>
      </dl>
    </section>



     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

      <div id="method-c-capture2" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              capture2([env, ] command_line, options = {}) &rarr; [stdout_s, status]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              capture2([env, ] exe_path, *args, options = {}) &rarr; [stdout_s, status]
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> with the given arguments (except for certain entries in hash <code>options</code>; see below).</p>
</li><li>
<p>Returns as string <code>stdout_s</code> the standard output of the child process.</p>
</li><li>
<p>Returns as <code>status</code> a <code>Process::Status</code> object that represents the exit status of the child process.</p>
</li></ul>

<p>Returns the array <code>[stdout_s, status]</code>:</p>

<pre class="ruby"><span class="ruby-identifier">stdout_s</span>, <span class="ruby-identifier">status</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2326047 exit 0&gt;]</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The hash <code>options</code> is given; two options have local effect in method <a href="Open3.html#method-c-capture2"><code>Open3.capture2</code></a>:</p>
<ul><li>
<p>If entry <code>options[:stdin_data]</code> exists, the entry is removed and its string value is sent to the command’s standard input:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;tee&#39;</span>, <span class="ruby-value">stdin_data:</span> <span class="ruby-string">&#39;Foo&#39;</span>)

<span class="ruby-comment"># =&gt; [&quot;Foo&quot;, #&lt;Process::Status: pid 2326087 exit 0&gt;]</span>
</pre>
</li><li>
<p>If entry <code>options[:binmode]</code> exists, the entry is removed and the internal streams are set to binary mode.</p>
</li></ul>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2326131 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;echo&#39;</span>)                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-comment"># =&gt; [&quot;\n&quot;, #&lt;Process::Status: pid 2326139 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>)              <span class="ruby-comment"># Contains meta character.</span>
<span class="ruby-comment"># =&gt; [&quot;&quot;, #&lt;Process::Status: pid 2326174 exit 0&gt;]</span>
</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2326183 exit 0&gt;]</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Fri Sep 29 01:00:39 PM CDT 2023\n&quot;, #&lt;Process::Status: pid 2326222 exit 0&gt;]</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;C #\n&quot;, #&lt;Process::Status: pid 2326267 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;hello world\n&quot;, #&lt;Process::Status: pid 2326299 exit 0&gt;]</span>
</pre>

          <div class="method-source-code" id="capture2-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 775</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">capture2</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">stdin_data</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:stdin_data</span>)
  <span class="ruby-identifier">binmode</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:binmode</span>)

  <span class="ruby-identifier">popen2</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">i</span>.<span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">o</span>.<span class="ruby-identifier">binmode</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">out_reader</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">o</span>.<span class="ruby-identifier">read</span> }
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">stdin_data</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">stdin_data</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:readpartial</span>
          <span class="ruby-constant">IO</span>.<span class="ruby-identifier">copy_stream</span>(<span class="ruby-identifier">stdin_data</span>, <span class="ruby-identifier">i</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">i</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">stdin_data</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EPIPE</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">i</span>.<span class="ruby-identifier">close</span>
    [<span class="ruby-identifier">out_reader</span>.<span class="ruby-identifier">value</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">value</span>]
  }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-c-capture2e" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              capture2e([env, ] command_line, options = {}) &rarr; [stdout_and_stderr_s, status]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              capture2e([env, ] exe_path, *args, options = {}) &rarr; [stdout_and_stderr_s, status]
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> with the given arguments (except for certain entries in hash <code>options</code>; see below).</p>
</li><li>
<p>Returns as string <code>stdout_and_stderr_s</code> the merged standard output and standard error of the child process.</p>
</li><li>
<p>Returns as <code>status</code> a <code>Process::Status</code> object that represents the exit status of the child process.</p>
</li></ul>

<p>Returns the array <code>[stdout_and_stderr_s, status]</code>:</p>

<pre class="ruby"><span class="ruby-identifier">stdout_and_stderr_s</span>, <span class="ruby-identifier">status</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2371692 exit 0&gt;]</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The hash <code>options</code> is given; two options have local effect in method <a href="Open3.html#method-c-capture2e"><code>Open3.capture2e</code></a>:</p>
<ul><li>
<p>If entry <code>options[:stdin_data]</code> exists, the entry is removed and its string value is sent to the command’s standard input:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;tee&#39;</span>, <span class="ruby-value">stdin_data:</span> <span class="ruby-string">&#39;Foo&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo&quot;, #&lt;Process::Status: pid 2371732 exit 0&gt;]</span>
</pre>
</li><li>
<p>If entry <code>options[:binmode]</code> exists, the entry is removed and the internal streams are set to binary mode.</p>
</li></ul>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2371740 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;echo&#39;</span>)                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-comment"># =&gt; [&quot;\n&quot;, #&lt;Process::Status: pid 2371774 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>)              <span class="ruby-comment"># Contains meta character.</span>
<span class="ruby-comment"># =&gt; [&quot;&quot;, #&lt;Process::Status: pid 2371812 exit 0&gt;]</span>
</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2326183 exit 0&gt;]</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Sat Sep 30 09:01:46 AM CDT 2023\n&quot;, #&lt;Process::Status: pid 2371820 exit 0&gt;]</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;C #\n&quot;, #&lt;Process::Status: pid 2371856 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;hello world\n&quot;, #&lt;Process::Status: pid 2371894 exit 0&gt;]</span>
</pre>

          <div class="method-source-code" id="capture2e-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 902</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">capture2e</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">stdin_data</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:stdin_data</span>)
  <span class="ruby-identifier">binmode</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:binmode</span>)

  <span class="ruby-identifier">popen2e</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">oe</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">i</span>.<span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">oe</span>.<span class="ruby-identifier">binmode</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">outerr_reader</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">oe</span>.<span class="ruby-identifier">read</span> }
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">stdin_data</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">stdin_data</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:readpartial</span>
          <span class="ruby-constant">IO</span>.<span class="ruby-identifier">copy_stream</span>(<span class="ruby-identifier">stdin_data</span>, <span class="ruby-identifier">i</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">i</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">stdin_data</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EPIPE</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">i</span>.<span class="ruby-identifier">close</span>
    [<span class="ruby-identifier">outerr_reader</span>.<span class="ruby-identifier">value</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">value</span>]
  }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-c-capture3" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              capture3([env, ] command_line, options = {}) &rarr; [stdout_s, stderr_s, status]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              capture3([env, ] exe_path, *args, options = {}) &rarr; [stdout_s, stderr_s, status]
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> with the given arguments (except for certain entries in hash <code>options</code>; see below).</p>
</li><li>
<p>Returns as strings <code>stdout_s</code> and <code>stderr_s</code> the standard output and standard error of the child process.</p>
</li><li>
<p>Returns as <code>status</code> a <code>Process::Status</code> object that represents the exit status of the child process.</p>
</li></ul>

<p>Returns the array <code>[stdout_s, stderr_s, status]</code>:</p>

<pre class="ruby"><span class="ruby-identifier">stdout_s</span>, <span class="ruby-identifier">stderr_s</span>, <span class="ruby-identifier">status</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2281954 exit 0&gt;]</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The hash <code>options</code> is given; two options have local effect in method <a href="Open3.html#method-c-capture3"><code>Open3.capture3</code></a>:</p>
<ul><li>
<p>If entry <code>options[:stdin_data]</code> exists, the entry is removed and its string value is sent to the command’s standard input:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;tee&#39;</span>, <span class="ruby-value">stdin_data:</span> <span class="ruby-string">&#39;Foo&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo&quot;, &quot;&quot;, #&lt;Process::Status: pid 2319575 exit 0&gt;]</span>
</pre>
</li><li>
<p>If entry <code>options[:binmode]</code> exists, the entry is removed and the internal streams are set to binary mode.</p>
</li></ul>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282025 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;echo&#39;</span>)                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-comment"># =&gt; [&quot;\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282092 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>)              <span class="ruby-comment"># Contains meta character.</span>
<span class="ruby-comment"># =&gt; [&quot;&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282110 exit 0&gt;]</span>
</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282092 exit 0&gt;]</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Thu Sep 28 05:03:51 PM CDT 2023\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282300 exit 0&gt;]</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;C #\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282368 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;hello world\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282372 exit 0&gt;]</span>
</pre>

          <div class="method-source-code" id="capture3-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 648</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">capture3</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">stdin_data</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:stdin_data</span>) <span class="ruby-operator">||</span> <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-identifier">binmode</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:binmode</span>)

  <span class="ruby-identifier">popen3</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">i</span>.<span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">o</span>.<span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">e</span>.<span class="ruby-identifier">binmode</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">out_reader</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">o</span>.<span class="ruby-identifier">read</span> }
    <span class="ruby-identifier">err_reader</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">e</span>.<span class="ruby-identifier">read</span> }
    <span class="ruby-keyword">begin</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">stdin_data</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:readpartial</span>
        <span class="ruby-constant">IO</span>.<span class="ruby-identifier">copy_stream</span>(<span class="ruby-identifier">stdin_data</span>, <span class="ruby-identifier">i</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">i</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">stdin_data</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EPIPE</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">i</span>.<span class="ruby-identifier">close</span>
    [<span class="ruby-identifier">out_reader</span>.<span class="ruby-identifier">value</span>, <span class="ruby-identifier">err_reader</span>.<span class="ruby-identifier">value</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">value</span>]
  }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-c-pipeline" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              pipeline([env, ] *cmds, options = {}) &rarr; array_of_statuses
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process for each of the given <code>cmds</code> by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>.</p>
</li><li>
<p>Pipes the <code>stdout</code> from each child to the <code>stdin</code> of the next child, or, for the last child, to the caller’s <code>stdout</code>.</p>
</li><li>
<p>Waits for the child processes to exit.</p>
</li><li>
<p>Returns an array of <a href="Process/Status.html"><code>Process::Status</code></a> objects (one for each child).</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">wait_threads</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline</span>(<span class="ruby-string">&#39;ls&#39;</span>, <span class="ruby-string">&#39;grep R&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;Process::Status: pid 2139200 exit 0&gt;, #&lt;Process::Status: pid 2139202 exit 0&gt;]</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-constant">Rakefile</span>
<span class="ruby-constant">README</span>.<span class="ruby-identifier">md</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>‘ see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>Each remaining argument in <code>cmds</code> is one of:</p>
<ul><li>
<p>A <code>command_line</code>: a string that begins with a shell reserved word or special built-in, or contains one or more metacharacters.</p>
</li><li>
<p>An <code>exe_path</code>: the string path to an executable to be called.</p>
</li><li>
<p>An array containing a <code>command_line</code> or an <code>exe_path</code>, along with zero or more string arguments for the command.</p>
</li></ul>

<p>See <a href="Process.html#module-Process-label-Argument+command_line+or+exe_path">Argument command_line or exe_path</a>.</p>

          <div class="method-source-code" id="pipeline-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 1334</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pipeline</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmds</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [], []) {<span class="ruby-operator">|</span><span class="ruby-identifier">ts</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">ts</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:value</span>)
  }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-c-pipeline_r" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              pipeline_r([env, ] *cmds, options = {}) &rarr; [last_stdout, wait_threads]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process for each of the given <code>cmds</code> by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>.</p>
</li><li>
<p>Pipes the <code>stdout</code> from each child to the <code>stdin</code> of the next child, or, for the last child, to the caller’s <code>stdout</code>.</p>
</li></ul>

<p>The method does not wait for child processes to exit, so the caller must do so.</p>

<p>With no block given, returns a 2-element array containing:</p>
<ul><li>
<p>The <code>stdout</code> stream of the last child process.</p>
</li><li>
<p>An array of the wait threads for all of the child processes.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">last_stdout</span>, <span class="ruby-identifier">wait_threads</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_r</span>(<span class="ruby-string">&#39;ls&#39;</span>, <span class="ruby-string">&#39;grep R&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 5&gt;, [#&lt;Process::Waiter:0x000055e8de2f9898 dead&gt;, #&lt;Process::Waiter:0x000055e8de2f94b0 sleep&gt;]]</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">last_stdout</span>.<span class="ruby-identifier">read</span>
<span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-constant">Rakefile</span>
<span class="ruby-constant">README</span>.<span class="ruby-identifier">md</span>
</pre>

<p>With a block given, calls the block with the <code>stdout</code> stream of the last child process, and an array of the wait processes:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_r</span>(<span class="ruby-string">&#39;ls&#39;</span>, <span class="ruby-string">&#39;grep R&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">last_stdout</span>, <span class="ruby-identifier">wait_threads</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">last_stdout</span>.<span class="ruby-identifier">read</span>
  <span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-constant">Rakefile</span>
<span class="ruby-constant">README</span>.<span class="ruby-identifier">md</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>Each remaining argument in <code>cmds</code> is one of:</p>
<ul><li>
<p>A <code>command_line</code>: a string that begins with a shell reserved word or special built-in, or contains one or more metacharacters.</p>
</li><li>
<p>An <code>exe_path</code>: the string path to an executable to be called.</p>
</li><li>
<p>An array containing a <code>command_line</code> or an <code>exe_path</code>, along with zero or more string arguments for the command.</p>
</li></ul>

<p>See <a href="Process.html#module-Process-label-Argument+command_line+or+exe_path">Argument command_line or exe_path</a>.</p>

          <div class="method-source-code" id="pipeline_r-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 1104</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pipeline_r</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmds</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">out_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:out</span>] = <span class="ruby-identifier">out_w</span>

  <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">out_w</span>], [<span class="ruby-identifier">out_r</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-c-pipeline_rw" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              pipeline_rw([env, ] *cmds, options = {}) &rarr; [first_stdin, last_stdout, wait_threads]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process for each of the given <code>cmds</code> by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>.</p>
</li><li>
<p>Pipes the <code>stdout</code> from each child to the <code>stdin</code> of the next child, or, for the first child, from the caller’s <code>stdin</code>, or, for the last child, to the caller’s <code>stdout</code>.</p>
</li></ul>

<p>The method does not wait for child processes to exit, so the caller must do so.</p>

<p>With no block given, returns a 3-element array containing:</p>
<ul><li>
<p>The <code>stdin</code> stream of the first child process.</p>
</li><li>
<p>The <code>stdout</code> stream of the last child process.</p>
</li><li>
<p>An array of the wait threads for all of the child processes.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">first_stdin</span>, <span class="ruby-identifier">last_stdout</span>, <span class="ruby-identifier">wait_threads</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_rw</span>(<span class="ruby-string">&#39;sort&#39;</span>, <span class="ruby-string">&#39;cat -n&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 20&gt;, #&lt;IO:fd 21&gt;, [#&lt;Process::Waiter:0x000055e8de29ab40 sleep&gt;, #&lt;Process::Waiter:0x000055e8de29a690 sleep&gt;]]</span>
<span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&quot;foo\nbar\nbaz&quot;</span>)
<span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">close</span> <span class="ruby-comment"># Send EOF to sort.</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">last_stdout</span>.<span class="ruby-identifier">read</span>
<span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre>1 bar
2 baz
3 foo</pre>

<p>With a block given, calls the block with the <code>stdin</code> stream of the first child, the <code>stdout</code> stream  of the last child, and an array of the wait processes:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_rw</span>(<span class="ruby-string">&#39;sort&#39;</span>, <span class="ruby-string">&#39;cat -n&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">first_stdin</span>, <span class="ruby-identifier">last_stdout</span>, <span class="ruby-identifier">wait_threads</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;foo\nbar\nbaz&quot;</span>
  <span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">close</span> <span class="ruby-comment"># send EOF to sort.</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">last_stdout</span>.<span class="ruby-identifier">read</span>
  <span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre>1 bar
2 baz
3 foo</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>Each remaining argument in <code>cmds</code> is one of:</p>
<ul><li>
<p>A <code>command_line</code>: a string that begins with a shell reserved word or special built-in, or contains one or more metacharacters.</p>
</li><li>
<p>An <code>exe_path</code>: the string path to an executable to be called.</p>
</li><li>
<p>An array containing a <code>command_line</code> or an <code>exe_path</code>, along with zero or more string arguments for the command.</p>
</li></ul>

<p>See <a href="Process.html#module-Process-label-Argument+command_line+or+exe_path">Argument command_line or exe_path</a>.</p>

          <div class="method-source-code" id="pipeline_rw-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 1014</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pipeline_rw</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmds</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">in_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:in</span>] = <span class="ruby-identifier">in_r</span>
  <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">out_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:out</span>] = <span class="ruby-identifier">out_w</span>

  <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">out_w</span>], [<span class="ruby-identifier">in_w</span>, <span class="ruby-identifier">out_r</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-c-pipeline_start" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              pipeline_start([env, ] *cmds, options = {}) &rarr; [wait_threads]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process for each of the given <code>cmds</code> by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>.</p>
</li><li>
<p>Does not wait for child processes to exit.</p>
</li></ul>

<p>With no block given, returns an array of the wait threads for all of the child processes.</p>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">wait_threads</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_start</span>(<span class="ruby-string">&#39;ls&#39;</span>, <span class="ruby-string">&#39;grep R&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;Process::Waiter:0x000055e8de9d2bb0 run&gt;, #&lt;Process::Waiter:0x000055e8de9d2890 run&gt;]</span>
<span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-constant">Rakefile</span>
<span class="ruby-constant">README</span>.<span class="ruby-identifier">md</span>
</pre>

<p>With a block given, calls the block with an array of the wait processes:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_start</span>(<span class="ruby-string">&#39;ls&#39;</span>, <span class="ruby-string">&#39;grep R&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_threads</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-constant">Rakefile</span>
<span class="ruby-constant">README</span>.<span class="ruby-identifier">md</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>Each remaining argument in <code>cmds</code> is one of:</p>
<ul><li>
<p>A <code>command_line</code>: a string that begins with a shell reserved word or special built-in, or contains one or more metacharacters.</p>
</li><li>
<p>An <code>exe_path</code>: the string path to an executable to be called.</p>
</li><li>
<p>An array containing a <code>command_line</code> or an <code>exe_path</code>, along with zero or more string arguments for the command.</p>
</li></ul>

<p>See <a href="Process.html#module-Process-label-Argument+command_line+or+exe_path">Argument command_line or exe_path</a>.</p>

          <div class="method-source-code" id="pipeline_start-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 1272</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pipeline_start</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmds</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
    <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [], [], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">ts</span>, = <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [], [])
    <span class="ruby-identifier">ts</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-c-pipeline_w" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              pipeline_w([env, ] *cmds, options = {}) &rarr; [first_stdin, wait_threads]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process for each of the given <code>cmds</code> by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>.</p>
</li><li>
<p>Pipes the <code>stdout</code> from each child to the <code>stdin</code> of the next child, or, for the first child, pipes the caller’s <code>stdout</code> to the child’s <code>stdin</code>.</p>
</li></ul>

<p>The method does not wait for child processes to exit, so the caller must do so.</p>

<p>With no block given, returns a 2-element array containing:</p>
<ul><li>
<p>The <code>stdin</code> stream of the first child process.</p>
</li><li>
<p>An array of the wait threads for all of the child processes.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">first_stdin</span>, <span class="ruby-identifier">wait_threads</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_w</span>(<span class="ruby-string">&#39;sort&#39;</span>, <span class="ruby-string">&#39;cat -n&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 7&gt;, [#&lt;Process::Waiter:0x000055e8de928278 run&gt;, #&lt;Process::Waiter:0x000055e8de923e80 run&gt;]]</span>
<span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&quot;foo\nbar\nbaz&quot;</span>)
<span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">close</span> <span class="ruby-comment"># Send EOF to sort.</span>
<span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre>1 bar
2 baz
3 foo</pre>

<p>With a block given, calls the block with the <code>stdin</code> stream of the first child process, and an array of the wait processes:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_w</span>(<span class="ruby-string">&#39;sort&#39;</span>, <span class="ruby-string">&#39;cat -n&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">first_stdin</span>, <span class="ruby-identifier">wait_threads</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&quot;foo\nbar\nbaz&quot;</span>)
  <span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">close</span> <span class="ruby-comment"># Send EOF to sort.</span>
  <span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre>1 bar
2 baz
3 foo</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>Each remaining argument in <code>cmds</code> is one of:</p>
<ul><li>
<p>A <code>command_line</code>: a string that begins with a shell reserved word or special built-in, or contains one or more metacharacters.</p>
</li><li>
<p>An <code>exe_path</code>: the string path to an executable to be called.</p>
</li><li>
<p>An array containing a <code>command_line</code> or an <code>exe_path</code>, along with zero or more string arguments for the command.</p>
</li></ul>

<p>See <a href="Process.html#module-Process-label-Argument+command_line+or+exe_path">Argument command_line or exe_path</a>.</p>

          <div class="method-source-code" id="pipeline_w-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 1195</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pipeline_w</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmds</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">in_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:in</span>] = <span class="ruby-identifier">in_r</span>
  <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">in_r</span>], [<span class="ruby-identifier">in_w</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-c-popen2" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              popen2([env, ] command_line, options = {}) &rarr; [stdin, stdout, wait_thread]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2([env, ] exe_path, *args, options = {}) &rarr; [stdin, stdout, wait_thread]
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2([env, ] command_line, options = {}) {|stdin, stdout, wait_thread| ... } &rarr; object
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2([env, ] exe_path, *args, options = {}) {|stdin, stdout, wait_thread| ... } &rarr; object
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> with the given arguments.</p>
</li><li>
<p>Creates streams <code>stdin</code> and <code>stdout</code>, which are the standard input and standard output streams in the child process.</p>
</li><li>
<p>Creates thread <code>wait_thread</code> that waits for the child process to exit; the thread has method <code>pid</code>, which returns the process ID of the child process.</p>
</li></ul>

<p>With no block given, returns the array <code>[stdin, stdout, wait_thread]</code>. The caller should close each of the two returned streams.</p>

<pre class="ruby"><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">wait_thread</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 6&gt;, #&lt;IO:fd 7&gt;, #&lt;Process::Waiter:0x00007f58d52dbe98 run&gt;]</span>
<span class="ruby-identifier">stdin</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">stdout</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>   <span class="ruby-comment"># =&gt; 2263572</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span> <span class="ruby-comment"># =&gt; #&lt;Process::Status: pid 2263572 exit 0&gt;</span>
</pre>

<p>With a block given, calls the block with the three variables (two streams and the wait thread) and returns the block’s return value. The caller need not close the streams:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdin</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdout</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-comment">#&lt;IO:fd 6&gt;</span>
<span class="ruby-comment">#&lt;IO:fd 7&gt;</span>
<span class="ruby-comment">#&lt;Process::Waiter:0x00007f58d59a34b0 sleep&gt;</span>
<span class="ruby-value">2263636</span>
<span class="ruby-comment">#&lt;Process::Status: pid 2263636 exit 0&gt;</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> } <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }              <span class="ruby-comment"># Contains meta character.</span>
</pre>

<p>Output (similar for each call above):</p>

<pre class="ruby"><span class="ruby-comment"># =&gt; [#&lt;IO:(closed)&gt;, #&lt;IO:(closed)&gt;, #&lt;Process::Waiter:0x00007f7577dfe410 dead&gt;]</span>
</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-string">&quot;Foo\n&quot;</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;Thu Sep 28 09:41:06 AM CDT 2023\n&quot;</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> } <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;C #\n&quot;</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;hello world\n&quot;</span>
</pre>

<p>Related:</p>
<ul><li>
<p><a href="Open3.html#method-c-popen2e"><code>Open3.popen2e</code></a>: Makes the standard input and the merge of the standard output and standard error streams of the child process available as separate streams.</p>
</li><li>
<p><a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>: Makes the standard input, standard output, and standard error streams of the child process available as separate streams.</p>
</li></ul>

          <div class="method-source-code" id="popen2-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 365</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">popen2</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">in_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:in</span>] = <span class="ruby-identifier">in_r</span>
  <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">out_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:out</span>] = <span class="ruby-identifier">out_w</span>

  <span class="ruby-identifier">popen_run</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">out_w</span>], [<span class="ruby-identifier">in_w</span>, <span class="ruby-identifier">out_r</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-c-popen2e" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              popen2e([env, ] command_line, options = {}) &rarr; [stdin, stdout_and_stderr, wait_thread]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2e([env, ] exe_path, *args, options = {}) &rarr; [stdin, stdout_and_stderr, wait_thread]
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2e([env, ] command_line, options = {}) {|stdin, stdout_and_stderr, wait_thread| ... } &rarr; object
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2e([env, ] exe_path, *args, options = {}) {|stdin, stdout_and_stderr, wait_thread| ... } &rarr; object
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> with the given arguments.</p>
</li><li>
<p>Creates streams <code>stdin</code>, <code>stdout_and_stderr</code>, which are the standard input and the merge of the standard output and standard error streams in the child process.</p>
</li><li>
<p>Creates thread <code>wait_thread</code> that waits for the child process to exit; the thread has method <code>pid</code>, which returns the process ID of the child process.</p>
</li></ul>

<p>With no block given, returns the array <code>[stdin, stdout_and_stderr, wait_thread]</code>. The caller should close each of the two returned streams.</p>

<pre class="ruby"><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout_and_stderr</span>, <span class="ruby-identifier">wait_thread</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 6&gt;, #&lt;IO:fd 7&gt;, #&lt;Process::Waiter:0x00007f7577da4398 run&gt;]</span>
<span class="ruby-identifier">stdin</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">stdout_and_stderr</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>   <span class="ruby-comment"># =&gt; 2274600</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span> <span class="ruby-comment"># =&gt; #&lt;Process::Status: pid 2274600 exit 0&gt;</span>
</pre>

<p>With a block given, calls the block with the three variables (two streams and the wait thread) and returns the block’s return value. The caller need not close the streams:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout_and_stderr</span>, <span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdin</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdout_and_stderr</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-comment">#&lt;IO:fd 6&gt;</span>
<span class="ruby-comment">#&lt;IO:fd 7&gt;</span>
<span class="ruby-comment">#&lt;Process::Waiter:0x00007f75777578c8 sleep&gt;</span>
<span class="ruby-value">2274763</span>
<span class="ruby-comment">#&lt;Process::Status: pid 2274763 exit 0&gt;</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> } <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }              <span class="ruby-comment"># Contains meta character.</span>
</pre>

<p>Output (similar for each call above):</p>

<pre class="ruby"><span class="ruby-comment"># =&gt; [#&lt;IO:(closed)&gt;, #&lt;IO:(closed)&gt;, #&lt;Process::Waiter:0x00007f7577d8a1f0 dead&gt;]</span>
</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o_and_e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o_and_e</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-string">&quot;Foo\n&quot;</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o_and_e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o_and_e</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;Thu Sep 28 01:58:45 PM CDT 2023\n&quot;</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o_and_e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o_and_e</span>.<span class="ruby-identifier">gets</span> } <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o_and_e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o_and_e</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;C #\n&quot;</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o_and_e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o_and_e</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;hello world\n&quot;</span>
</pre>

<p>Related:</p>
<ul><li>
<p><a href="Open3.html#method-c-popen2"><code>Open3.popen2</code></a>: Makes the standard input and standard output streams of the child process available as separate streams, with no access to the standard error stream.</p>
</li><li>
<p><a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>: Makes the standard input, standard output, and standard error streams of the child process available as separate streams.</p>
</li></ul>

          <div class="method-source-code" id="popen2e-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 508</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">popen2e</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">in_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:in</span>] = <span class="ruby-identifier">in_r</span>
  <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">out_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[[<span class="ruby-value">:out</span>, <span class="ruby-value">:err</span>]] = <span class="ruby-identifier">out_w</span>

  <span class="ruby-identifier">popen_run</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">out_w</span>], [<span class="ruby-identifier">in_w</span>, <span class="ruby-identifier">out_r</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">ensure</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
    <span class="ruby-identifier">in_r</span>.<span class="ruby-identifier">close</span>
    <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">close</span>
    <span class="ruby-identifier">out_r</span>.<span class="ruby-identifier">close</span>
    <span class="ruby-identifier">out_w</span>.<span class="ruby-identifier">close</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-c-popen3" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              popen3([env, ] command_line, options = {}) &rarr; [stdin, stdout, stderr, wait_thread]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen3([env, ] exe_path, *args, options = {}) &rarr; [stdin, stdout, stderr, wait_thread]
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen3([env, ] command_line, options = {}) {|stdin, stdout, stderr, wait_thread| ... } &rarr; object
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen3([env, ] exe_path, *args, options = {}) {|stdin, stdout, stderr, wait_thread| ... } &rarr; object
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> with the given arguments.</p>
</li><li>
<p>Creates streams <code>stdin</code>, <code>stdout</code>, and <code>stderr</code>, which are the standard input, standard output, and standard error streams in the child process.</p>
</li><li>
<p>Creates thread <code>wait_thread</code> that waits for the child process to exit; the thread has method <code>pid</code>, which returns the process ID of the child process.</p>
</li></ul>

<p>With no block given, returns the array <code>[stdin, stdout, stderr, wait_thread]</code>. The caller should close each of the three returned streams.</p>

<pre class="ruby"><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">stderr</span>, <span class="ruby-identifier">wait_thread</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 8&gt;, #&lt;IO:fd 10&gt;, #&lt;IO:fd 12&gt;, #&lt;Process::Waiter:0x00007f58d5428f58 run&gt;]</span>
<span class="ruby-identifier">stdin</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">stdout</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">stderr</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>   <span class="ruby-comment"># =&gt; 2210481</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span> <span class="ruby-comment"># =&gt; #&lt;Process::Status: pid 2210481 exit 0&gt;</span>
</pre>

<p>With a block given, calls the block with the four variables (three streams and the wait thread) and returns the block’s return value. The caller need not close the streams:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">stderr</span>, <span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdin</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdout</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stderr</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-comment">#&lt;IO:fd 6&gt;</span>
<span class="ruby-comment">#&lt;IO:fd 7&gt;</span>
<span class="ruby-comment">#&lt;IO:fd 9&gt;</span>
<span class="ruby-comment">#&lt;Process::Waiter:0x00007f58d53606e8 sleep&gt;</span>
<span class="ruby-value">2211047</span>
<span class="ruby-comment">#&lt;Process::Status: pid 2211047 exit 0&gt;</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> } <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }              <span class="ruby-comment"># Contains meta character.</span>
</pre>

<p>Output (similar for each call above):</p>

<pre>[#&lt;IO:(closed)&gt;, #&lt;IO:(closed)&gt;, #&lt;IO:(closed)&gt;, #&lt;Process::Waiter:0x00007f58d52f28c8 dead&gt;]</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-string">&quot;Foo\n&quot;</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;Wed Sep 27 02:56:44 PM CDT 2023\n&quot;</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> } <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;C #\n&quot;</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;hello world\n&quot;</span>
</pre>

<p>Take care to avoid deadlocks. Output streams <code>stdout</code> and <code>stderr</code> have fixed-size buffers, so reading extensively from one but not the other can cause a deadlock when the unread buffer fills. To avoid that, <code>stdout</code> and <code>stderr</code> should be read simultaneously (using threads or <a href="IO.html#method-c-select"><code>IO.select</code></a>).</p>

<p>Related:</p>
<ul><li>
<p><a href="Open3.html#method-c-popen2"><code>Open3.popen2</code></a>: Makes the standard input and standard output streams of the child process available as separate streams, with no access to the standard error stream.</p>
</li><li>
<p><a href="Open3.html#method-c-popen2e"><code>Open3.popen2e</code></a>: Makes the standard input and the merge of the standard output and standard error streams of the child process available as separate streams.</p>
</li></ul>

          <div class="method-source-code" id="popen3-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 218</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">popen3</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">in_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:in</span>] = <span class="ruby-identifier">in_r</span>
  <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">out_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:out</span>] = <span class="ruby-identifier">out_w</span>

  <span class="ruby-identifier">err_r</span>, <span class="ruby-identifier">err_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:err</span>] = <span class="ruby-identifier">err_w</span>

  <span class="ruby-identifier">popen_run</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">out_w</span>, <span class="ruby-identifier">err_w</span>], [<span class="ruby-identifier">in_w</span>, <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">err_r</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

    </section>

     <section id="private-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Instance Methods</h3>
       </header>

      <div id="method-i-capture2" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              capture2([env, ] command_line, options = {}) &rarr; [stdout_s, status]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              capture2([env, ] exe_path, *args, options = {}) &rarr; [stdout_s, status]
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> with the given arguments (except for certain entries in hash <code>options</code>; see below).</p>
</li><li>
<p>Returns as string <code>stdout_s</code> the standard output of the child process.</p>
</li><li>
<p>Returns as <code>status</code> a <code>Process::Status</code> object that represents the exit status of the child process.</p>
</li></ul>

<p>Returns the array <code>[stdout_s, status]</code>:</p>

<pre class="ruby"><span class="ruby-identifier">stdout_s</span>, <span class="ruby-identifier">status</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2326047 exit 0&gt;]</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The hash <code>options</code> is given; two options have local effect in method <a href="Open3.html#method-c-capture2"><code>Open3.capture2</code></a>:</p>
<ul><li>
<p>If entry <code>options[:stdin_data]</code> exists, the entry is removed and its string value is sent to the command’s standard input:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;tee&#39;</span>, <span class="ruby-value">stdin_data:</span> <span class="ruby-string">&#39;Foo&#39;</span>)

<span class="ruby-comment"># =&gt; [&quot;Foo&quot;, #&lt;Process::Status: pid 2326087 exit 0&gt;]</span>
</pre>
</li><li>
<p>If entry <code>options[:binmode]</code> exists, the entry is removed and the internal streams are set to binary mode.</p>
</li></ul>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2326131 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;echo&#39;</span>)                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-comment"># =&gt; [&quot;\n&quot;, #&lt;Process::Status: pid 2326139 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>)              <span class="ruby-comment"># Contains meta character.</span>
<span class="ruby-comment"># =&gt; [&quot;&quot;, #&lt;Process::Status: pid 2326174 exit 0&gt;]</span>
</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2326183 exit 0&gt;]</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Fri Sep 29 01:00:39 PM CDT 2023\n&quot;, #&lt;Process::Status: pid 2326222 exit 0&gt;]</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;C #\n&quot;, #&lt;Process::Status: pid 2326267 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;hello world\n&quot;, #&lt;Process::Status: pid 2326299 exit 0&gt;]</span>
</pre>

          <div class="method-source-code" id="capture2-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 775</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">capture2</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">stdin_data</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:stdin_data</span>)
  <span class="ruby-identifier">binmode</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:binmode</span>)

  <span class="ruby-identifier">popen2</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">i</span>.<span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">o</span>.<span class="ruby-identifier">binmode</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">out_reader</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">o</span>.<span class="ruby-identifier">read</span> }
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">stdin_data</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">stdin_data</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:readpartial</span>
          <span class="ruby-constant">IO</span>.<span class="ruby-identifier">copy_stream</span>(<span class="ruby-identifier">stdin_data</span>, <span class="ruby-identifier">i</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">i</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">stdin_data</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EPIPE</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">i</span>.<span class="ruby-identifier">close</span>
    [<span class="ruby-identifier">out_reader</span>.<span class="ruby-identifier">value</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">value</span>]
  }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-capture2e" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              capture2e([env, ] command_line, options = {}) &rarr; [stdout_and_stderr_s, status]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              capture2e([env, ] exe_path, *args, options = {}) &rarr; [stdout_and_stderr_s, status]
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> with the given arguments (except for certain entries in hash <code>options</code>; see below).</p>
</li><li>
<p>Returns as string <code>stdout_and_stderr_s</code> the merged standard output and standard error of the child process.</p>
</li><li>
<p>Returns as <code>status</code> a <code>Process::Status</code> object that represents the exit status of the child process.</p>
</li></ul>

<p>Returns the array <code>[stdout_and_stderr_s, status]</code>:</p>

<pre class="ruby"><span class="ruby-identifier">stdout_and_stderr_s</span>, <span class="ruby-identifier">status</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2371692 exit 0&gt;]</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The hash <code>options</code> is given; two options have local effect in method <a href="Open3.html#method-c-capture2e"><code>Open3.capture2e</code></a>:</p>
<ul><li>
<p>If entry <code>options[:stdin_data]</code> exists, the entry is removed and its string value is sent to the command’s standard input:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;tee&#39;</span>, <span class="ruby-value">stdin_data:</span> <span class="ruby-string">&#39;Foo&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo&quot;, #&lt;Process::Status: pid 2371732 exit 0&gt;]</span>
</pre>
</li><li>
<p>If entry <code>options[:binmode]</code> exists, the entry is removed and the internal streams are set to binary mode.</p>
</li></ul>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2371740 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;echo&#39;</span>)                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-comment"># =&gt; [&quot;\n&quot;, #&lt;Process::Status: pid 2371774 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>)              <span class="ruby-comment"># Contains meta character.</span>
<span class="ruby-comment"># =&gt; [&quot;&quot;, #&lt;Process::Status: pid 2371812 exit 0&gt;]</span>
</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, #&lt;Process::Status: pid 2326183 exit 0&gt;]</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Sat Sep 30 09:01:46 AM CDT 2023\n&quot;, #&lt;Process::Status: pid 2371820 exit 0&gt;]</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;C #\n&quot;, #&lt;Process::Status: pid 2371856 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture2e</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;hello world\n&quot;, #&lt;Process::Status: pid 2371894 exit 0&gt;]</span>
</pre>

          <div class="method-source-code" id="capture2e-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 902</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">capture2e</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">stdin_data</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:stdin_data</span>)
  <span class="ruby-identifier">binmode</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:binmode</span>)

  <span class="ruby-identifier">popen2e</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">oe</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">i</span>.<span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">oe</span>.<span class="ruby-identifier">binmode</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">outerr_reader</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">oe</span>.<span class="ruby-identifier">read</span> }
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">stdin_data</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">stdin_data</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:readpartial</span>
          <span class="ruby-constant">IO</span>.<span class="ruby-identifier">copy_stream</span>(<span class="ruby-identifier">stdin_data</span>, <span class="ruby-identifier">i</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">i</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">stdin_data</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EPIPE</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">i</span>.<span class="ruby-identifier">close</span>
    [<span class="ruby-identifier">outerr_reader</span>.<span class="ruby-identifier">value</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">value</span>]
  }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-capture3" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              capture3([env, ] command_line, options = {}) &rarr; [stdout_s, stderr_s, status]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              capture3([env, ] exe_path, *args, options = {}) &rarr; [stdout_s, stderr_s, status]
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a> with the given arguments (except for certain entries in hash <code>options</code>; see below).</p>
</li><li>
<p>Returns as strings <code>stdout_s</code> and <code>stderr_s</code> the standard output and standard error of the child process.</p>
</li><li>
<p>Returns as <code>status</code> a <code>Process::Status</code> object that represents the exit status of the child process.</p>
</li></ul>

<p>Returns the array <code>[stdout_s, stderr_s, status]</code>:</p>

<pre class="ruby"><span class="ruby-identifier">stdout_s</span>, <span class="ruby-identifier">stderr_s</span>, <span class="ruby-identifier">status</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2281954 exit 0&gt;]</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The hash <code>options</code> is given; two options have local effect in method <a href="Open3.html#method-c-capture3"><code>Open3.capture3</code></a>:</p>
<ul><li>
<p>If entry <code>options[:stdin_data]</code> exists, the entry is removed and its string value is sent to the command’s standard input:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;tee&#39;</span>, <span class="ruby-value">stdin_data:</span> <span class="ruby-string">&#39;Foo&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo&quot;, &quot;&quot;, #&lt;Process::Status: pid 2319575 exit 0&gt;]</span>
</pre>
</li><li>
<p>If entry <code>options[:binmode]</code> exists, the entry is removed and the internal streams are set to binary mode.</p>
</li></ul>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282025 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;echo&#39;</span>)                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-comment"># =&gt; [&quot;\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282092 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>)              <span class="ruby-comment"># Contains meta character.</span>
<span class="ruby-comment"># =&gt; [&quot;&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282110 exit 0&gt;]</span>
</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Foo\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282092 exit 0&gt;]</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;Thu Sep 28 05:03:51 PM CDT 2023\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282300 exit 0&gt;]</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;C #\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282368 exit 0&gt;]</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">capture3</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>)
<span class="ruby-comment"># =&gt; [&quot;hello world\n&quot;, &quot;&quot;, #&lt;Process::Status: pid 2282372 exit 0&gt;]</span>
</pre>

          <div class="method-source-code" id="capture3-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 648</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">capture3</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">stdin_data</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:stdin_data</span>) <span class="ruby-operator">||</span> <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-identifier">binmode</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:binmode</span>)

  <span class="ruby-identifier">popen3</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">i</span>.<span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">o</span>.<span class="ruby-identifier">binmode</span>
      <span class="ruby-identifier">e</span>.<span class="ruby-identifier">binmode</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">out_reader</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">o</span>.<span class="ruby-identifier">read</span> }
    <span class="ruby-identifier">err_reader</span> = <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">e</span>.<span class="ruby-identifier">read</span> }
    <span class="ruby-keyword">begin</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">stdin_data</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:readpartial</span>
        <span class="ruby-constant">IO</span>.<span class="ruby-identifier">copy_stream</span>(<span class="ruby-identifier">stdin_data</span>, <span class="ruby-identifier">i</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">i</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">stdin_data</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EPIPE</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">i</span>.<span class="ruby-identifier">close</span>
    [<span class="ruby-identifier">out_reader</span>.<span class="ruby-identifier">value</span>, <span class="ruby-identifier">err_reader</span>.<span class="ruby-identifier">value</span>, <span class="ruby-identifier">t</span>.<span class="ruby-identifier">value</span>]
  }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-pipeline" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              pipeline([env, ] *cmds, options = {}) &rarr; array_of_statuses
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process for each of the given <code>cmds</code> by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>.</p>
</li><li>
<p>Pipes the <code>stdout</code> from each child to the <code>stdin</code> of the next child, or, for the last child, to the caller’s <code>stdout</code>.</p>
</li><li>
<p>Waits for the child processes to exit.</p>
</li><li>
<p>Returns an array of <a href="Process/Status.html"><code>Process::Status</code></a> objects (one for each child).</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">wait_threads</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline</span>(<span class="ruby-string">&#39;ls&#39;</span>, <span class="ruby-string">&#39;grep R&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;Process::Status: pid 2139200 exit 0&gt;, #&lt;Process::Status: pid 2139202 exit 0&gt;]</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-constant">Rakefile</span>
<span class="ruby-constant">README</span>.<span class="ruby-identifier">md</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>‘ see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>Each remaining argument in <code>cmds</code> is one of:</p>
<ul><li>
<p>A <code>command_line</code>: a string that begins with a shell reserved word or special built-in, or contains one or more metacharacters.</p>
</li><li>
<p>An <code>exe_path</code>: the string path to an executable to be called.</p>
</li><li>
<p>An array containing a <code>command_line</code> or an <code>exe_path</code>, along with zero or more string arguments for the command.</p>
</li></ul>

<p>See <a href="Process.html#module-Process-label-Argument+command_line+or+exe_path">Argument command_line or exe_path</a>.</p>

          <div class="method-source-code" id="pipeline-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 1334</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pipeline</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmds</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [], []) {<span class="ruby-operator">|</span><span class="ruby-identifier">ts</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">ts</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:value</span>)
  }
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-pipeline_r" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              pipeline_r([env, ] *cmds, options = {}) &rarr; [last_stdout, wait_threads]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process for each of the given <code>cmds</code> by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>.</p>
</li><li>
<p>Pipes the <code>stdout</code> from each child to the <code>stdin</code> of the next child, or, for the last child, to the caller’s <code>stdout</code>.</p>
</li></ul>

<p>The method does not wait for child processes to exit, so the caller must do so.</p>

<p>With no block given, returns a 2-element array containing:</p>
<ul><li>
<p>The <code>stdout</code> stream of the last child process.</p>
</li><li>
<p>An array of the wait threads for all of the child processes.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">last_stdout</span>, <span class="ruby-identifier">wait_threads</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_r</span>(<span class="ruby-string">&#39;ls&#39;</span>, <span class="ruby-string">&#39;grep R&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 5&gt;, [#&lt;Process::Waiter:0x000055e8de2f9898 dead&gt;, #&lt;Process::Waiter:0x000055e8de2f94b0 sleep&gt;]]</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">last_stdout</span>.<span class="ruby-identifier">read</span>
<span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-constant">Rakefile</span>
<span class="ruby-constant">README</span>.<span class="ruby-identifier">md</span>
</pre>

<p>With a block given, calls the block with the <code>stdout</code> stream of the last child process, and an array of the wait processes:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_r</span>(<span class="ruby-string">&#39;ls&#39;</span>, <span class="ruby-string">&#39;grep R&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">last_stdout</span>, <span class="ruby-identifier">wait_threads</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">last_stdout</span>.<span class="ruby-identifier">read</span>
  <span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-constant">Rakefile</span>
<span class="ruby-constant">README</span>.<span class="ruby-identifier">md</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>Each remaining argument in <code>cmds</code> is one of:</p>
<ul><li>
<p>A <code>command_line</code>: a string that begins with a shell reserved word or special built-in, or contains one or more metacharacters.</p>
</li><li>
<p>An <code>exe_path</code>: the string path to an executable to be called.</p>
</li><li>
<p>An array containing a <code>command_line</code> or an <code>exe_path</code>, along with zero or more string arguments for the command.</p>
</li></ul>

<p>See <a href="Process.html#module-Process-label-Argument+command_line+or+exe_path">Argument command_line or exe_path</a>.</p>

          <div class="method-source-code" id="pipeline_r-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 1104</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pipeline_r</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmds</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">out_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:out</span>] = <span class="ruby-identifier">out_w</span>

  <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">out_w</span>], [<span class="ruby-identifier">out_r</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-pipeline_rw" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              pipeline_rw([env, ] *cmds, options = {}) &rarr; [first_stdin, last_stdout, wait_threads]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process for each of the given <code>cmds</code> by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>.</p>
</li><li>
<p>Pipes the <code>stdout</code> from each child to the <code>stdin</code> of the next child, or, for the first child, from the caller’s <code>stdin</code>, or, for the last child, to the caller’s <code>stdout</code>.</p>
</li></ul>

<p>The method does not wait for child processes to exit, so the caller must do so.</p>

<p>With no block given, returns a 3-element array containing:</p>
<ul><li>
<p>The <code>stdin</code> stream of the first child process.</p>
</li><li>
<p>The <code>stdout</code> stream of the last child process.</p>
</li><li>
<p>An array of the wait threads for all of the child processes.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">first_stdin</span>, <span class="ruby-identifier">last_stdout</span>, <span class="ruby-identifier">wait_threads</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_rw</span>(<span class="ruby-string">&#39;sort&#39;</span>, <span class="ruby-string">&#39;cat -n&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 20&gt;, #&lt;IO:fd 21&gt;, [#&lt;Process::Waiter:0x000055e8de29ab40 sleep&gt;, #&lt;Process::Waiter:0x000055e8de29a690 sleep&gt;]]</span>
<span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&quot;foo\nbar\nbaz&quot;</span>)
<span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">close</span> <span class="ruby-comment"># Send EOF to sort.</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">last_stdout</span>.<span class="ruby-identifier">read</span>
<span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre>1 bar
2 baz
3 foo</pre>

<p>With a block given, calls the block with the <code>stdin</code> stream of the first child, the <code>stdout</code> stream  of the last child, and an array of the wait processes:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_rw</span>(<span class="ruby-string">&#39;sort&#39;</span>, <span class="ruby-string">&#39;cat -n&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">first_stdin</span>, <span class="ruby-identifier">last_stdout</span>, <span class="ruby-identifier">wait_threads</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;foo\nbar\nbaz&quot;</span>
  <span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">close</span> <span class="ruby-comment"># send EOF to sort.</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">last_stdout</span>.<span class="ruby-identifier">read</span>
  <span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre>1 bar
2 baz
3 foo</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>Each remaining argument in <code>cmds</code> is one of:</p>
<ul><li>
<p>A <code>command_line</code>: a string that begins with a shell reserved word or special built-in, or contains one or more metacharacters.</p>
</li><li>
<p>An <code>exe_path</code>: the string path to an executable to be called.</p>
</li><li>
<p>An array containing a <code>command_line</code> or an <code>exe_path</code>, along with zero or more string arguments for the command.</p>
</li></ul>

<p>See <a href="Process.html#module-Process-label-Argument+command_line+or+exe_path">Argument command_line or exe_path</a>.</p>

          <div class="method-source-code" id="pipeline_rw-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 1014</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pipeline_rw</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmds</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">in_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:in</span>] = <span class="ruby-identifier">in_r</span>
  <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">out_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:out</span>] = <span class="ruby-identifier">out_w</span>

  <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">out_w</span>], [<span class="ruby-identifier">in_w</span>, <span class="ruby-identifier">out_r</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-pipeline_start" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              pipeline_start([env, ] *cmds, options = {}) &rarr; [wait_threads]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process for each of the given <code>cmds</code> by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>.</p>
</li><li>
<p>Does not wait for child processes to exit.</p>
</li></ul>

<p>With no block given, returns an array of the wait threads for all of the child processes.</p>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">wait_threads</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_start</span>(<span class="ruby-string">&#39;ls&#39;</span>, <span class="ruby-string">&#39;grep R&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;Process::Waiter:0x000055e8de9d2bb0 run&gt;, #&lt;Process::Waiter:0x000055e8de9d2890 run&gt;]</span>
<span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-constant">Rakefile</span>
<span class="ruby-constant">README</span>.<span class="ruby-identifier">md</span>
</pre>

<p>With a block given, calls the block with an array of the wait processes:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_start</span>(<span class="ruby-string">&#39;ls&#39;</span>, <span class="ruby-string">&#39;grep R&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_threads</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-constant">Rakefile</span>
<span class="ruby-constant">README</span>.<span class="ruby-identifier">md</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>Each remaining argument in <code>cmds</code> is one of:</p>
<ul><li>
<p>A <code>command_line</code>: a string that begins with a shell reserved word or special built-in, or contains one or more metacharacters.</p>
</li><li>
<p>An <code>exe_path</code>: the string path to an executable to be called.</p>
</li><li>
<p>An array containing a <code>command_line</code> or an <code>exe_path</code>, along with zero or more string arguments for the command.</p>
</li></ul>

<p>See <a href="Process.html#module-Process-label-Argument+command_line+or+exe_path">Argument command_line or exe_path</a>.</p>

          <div class="method-source-code" id="pipeline_start-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 1272</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pipeline_start</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmds</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
    <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [], [], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">ts</span>, = <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [], [])
    <span class="ruby-identifier">ts</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-pipeline_w" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              pipeline_w([env, ] *cmds, options = {}) &rarr; [first_stdin, wait_threads]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process for each of the given <code>cmds</code> by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>.</p>
</li><li>
<p>Pipes the <code>stdout</code> from each child to the <code>stdin</code> of the next child, or, for the first child, pipes the caller’s <code>stdout</code> to the child’s <code>stdin</code>.</p>
</li></ul>

<p>The method does not wait for child processes to exit, so the caller must do so.</p>

<p>With no block given, returns a 2-element array containing:</p>
<ul><li>
<p>The <code>stdin</code> stream of the first child process.</p>
</li><li>
<p>An array of the wait threads for all of the child processes.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">first_stdin</span>, <span class="ruby-identifier">wait_threads</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_w</span>(<span class="ruby-string">&#39;sort&#39;</span>, <span class="ruby-string">&#39;cat -n&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 7&gt;, [#&lt;Process::Waiter:0x000055e8de928278 run&gt;, #&lt;Process::Waiter:0x000055e8de923e80 run&gt;]]</span>
<span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&quot;foo\nbar\nbaz&quot;</span>)
<span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">close</span> <span class="ruby-comment"># Send EOF to sort.</span>
<span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre>1 bar
2 baz
3 foo</pre>

<p>With a block given, calls the block with the <code>stdin</code> stream of the first child process, and an array of the wait processes:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">pipeline_w</span>(<span class="ruby-string">&#39;sort&#39;</span>, <span class="ruby-string">&#39;cat -n&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">first_stdin</span>, <span class="ruby-identifier">wait_threads</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&quot;foo\nbar\nbaz&quot;</span>)
  <span class="ruby-identifier">first_stdin</span>.<span class="ruby-identifier">close</span> <span class="ruby-comment"># Send EOF to sort.</span>
  <span class="ruby-identifier">wait_threads</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">join</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre>1 bar
2 baz
3 foo</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in each call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>Each remaining argument in <code>cmds</code> is one of:</p>
<ul><li>
<p>A <code>command_line</code>: a string that begins with a shell reserved word or special built-in, or contains one or more metacharacters.</p>
</li><li>
<p>An <code>exe_path</code>: the string path to an executable to be called.</p>
</li><li>
<p>An array containing a <code>command_line</code> or an <code>exe_path</code>, along with zero or more string arguments for the command.</p>
</li></ul>

<p>See <a href="Process.html#module-Process-label-Argument+command_line+or+exe_path">Argument command_line or exe_path</a>.</p>

          <div class="method-source-code" id="pipeline_w-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 1195</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pipeline_w</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmds</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmds</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">in_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:in</span>] = <span class="ruby-identifier">in_r</span>
  <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">pipeline_run</span>(<span class="ruby-identifier">cmds</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">in_r</span>], [<span class="ruby-identifier">in_w</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-popen2" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              popen2([env, ] command_line, options = {}) &rarr; [stdin, stdout, wait_thread]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2([env, ] exe_path, *args, options = {}) &rarr; [stdin, stdout, wait_thread]
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2([env, ] command_line, options = {}) {|stdin, stdout, wait_thread| ... } &rarr; object
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2([env, ] exe_path, *args, options = {}) {|stdin, stdout, wait_thread| ... } &rarr; object
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> with the given arguments.</p>
</li><li>
<p>Creates streams <code>stdin</code> and <code>stdout</code>, which are the standard input and standard output streams in the child process.</p>
</li><li>
<p>Creates thread <code>wait_thread</code> that waits for the child process to exit; the thread has method <code>pid</code>, which returns the process ID of the child process.</p>
</li></ul>

<p>With no block given, returns the array <code>[stdin, stdout, wait_thread]</code>. The caller should close each of the two returned streams.</p>

<pre class="ruby"><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">wait_thread</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 6&gt;, #&lt;IO:fd 7&gt;, #&lt;Process::Waiter:0x00007f58d52dbe98 run&gt;]</span>
<span class="ruby-identifier">stdin</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">stdout</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>   <span class="ruby-comment"># =&gt; 2263572</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span> <span class="ruby-comment"># =&gt; #&lt;Process::Status: pid 2263572 exit 0&gt;</span>
</pre>

<p>With a block given, calls the block with the three variables (two streams and the wait thread) and returns the block’s return value. The caller need not close the streams:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdin</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdout</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-comment">#&lt;IO:fd 6&gt;</span>
<span class="ruby-comment">#&lt;IO:fd 7&gt;</span>
<span class="ruby-comment">#&lt;Process::Waiter:0x00007f58d59a34b0 sleep&gt;</span>
<span class="ruby-value">2263636</span>
<span class="ruby-comment">#&lt;Process::Status: pid 2263636 exit 0&gt;</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> } <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }              <span class="ruby-comment"># Contains meta character.</span>
</pre>

<p>Output (similar for each call above):</p>

<pre class="ruby"><span class="ruby-comment"># =&gt; [#&lt;IO:(closed)&gt;, #&lt;IO:(closed)&gt;, #&lt;Process::Waiter:0x00007f7577dfe410 dead&gt;]</span>
</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-string">&quot;Foo\n&quot;</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;Thu Sep 28 09:41:06 AM CDT 2023\n&quot;</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> } <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;C #\n&quot;</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;hello world\n&quot;</span>
</pre>

<p>Related:</p>
<ul><li>
<p><a href="Open3.html#method-c-popen2e"><code>Open3.popen2e</code></a>: Makes the standard input and the merge of the standard output and standard error streams of the child process available as separate streams.</p>
</li><li>
<p><a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>: Makes the standard input, standard output, and standard error streams of the child process available as separate streams.</p>
</li></ul>

          <div class="method-source-code" id="popen2-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 365</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">popen2</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">in_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:in</span>] = <span class="ruby-identifier">in_r</span>
  <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">out_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:out</span>] = <span class="ruby-identifier">out_w</span>

  <span class="ruby-identifier">popen_run</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">out_w</span>], [<span class="ruby-identifier">in_w</span>, <span class="ruby-identifier">out_r</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-popen2e" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              popen2e([env, ] command_line, options = {}) &rarr; [stdin, stdout_and_stderr, wait_thread]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2e([env, ] exe_path, *args, options = {}) &rarr; [stdin, stdout_and_stderr, wait_thread]
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2e([env, ] command_line, options = {}) {|stdin, stdout_and_stderr, wait_thread| ... } &rarr; object
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen2e([env, ] exe_path, *args, options = {}) {|stdin, stdout_and_stderr, wait_thread| ... } &rarr; object
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> with the given arguments.</p>
</li><li>
<p>Creates streams <code>stdin</code>, <code>stdout_and_stderr</code>, which are the standard input and the merge of the standard output and standard error streams in the child process.</p>
</li><li>
<p>Creates thread <code>wait_thread</code> that waits for the child process to exit; the thread has method <code>pid</code>, which returns the process ID of the child process.</p>
</li></ul>

<p>With no block given, returns the array <code>[stdin, stdout_and_stderr, wait_thread]</code>. The caller should close each of the two returned streams.</p>

<pre class="ruby"><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout_and_stderr</span>, <span class="ruby-identifier">wait_thread</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 6&gt;, #&lt;IO:fd 7&gt;, #&lt;Process::Waiter:0x00007f7577da4398 run&gt;]</span>
<span class="ruby-identifier">stdin</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">stdout_and_stderr</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>   <span class="ruby-comment"># =&gt; 2274600</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span> <span class="ruby-comment"># =&gt; #&lt;Process::Status: pid 2274600 exit 0&gt;</span>
</pre>

<p>With a block given, calls the block with the three variables (two streams and the wait thread) and returns the block’s return value. The caller need not close the streams:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout_and_stderr</span>, <span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdin</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdout_and_stderr</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-comment">#&lt;IO:fd 6&gt;</span>
<span class="ruby-comment">#&lt;IO:fd 7&gt;</span>
<span class="ruby-comment">#&lt;Process::Waiter:0x00007f75777578c8 sleep&gt;</span>
<span class="ruby-value">2274763</span>
<span class="ruby-comment">#&lt;Process::Status: pid 2274763 exit 0&gt;</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> } <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }              <span class="ruby-comment"># Contains meta character.</span>
</pre>

<p>Output (similar for each call above):</p>

<pre class="ruby"><span class="ruby-comment"># =&gt; [#&lt;IO:(closed)&gt;, #&lt;IO:(closed)&gt;, #&lt;Process::Waiter:0x00007f7577d8a1f0 dead&gt;]</span>
</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o_and_e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o_and_e</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-string">&quot;Foo\n&quot;</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o_and_e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o_and_e</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;Thu Sep 28 01:58:45 PM CDT 2023\n&quot;</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o_and_e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o_and_e</span>.<span class="ruby-identifier">gets</span> } <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o_and_e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o_and_e</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;C #\n&quot;</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen2e</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o_and_e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o_and_e</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;hello world\n&quot;</span>
</pre>

<p>Related:</p>
<ul><li>
<p><a href="Open3.html#method-c-popen2"><code>Open3.popen2</code></a>: Makes the standard input and standard output streams of the child process available as separate streams, with no access to the standard error stream.</p>
</li><li>
<p><a href="Open3.html#method-c-popen3"><code>Open3.popen3</code></a>: Makes the standard input, standard output, and standard error streams of the child process available as separate streams.</p>
</li></ul>

          <div class="method-source-code" id="popen2e-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 508</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">popen2e</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">in_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:in</span>] = <span class="ruby-identifier">in_r</span>
  <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">out_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[[<span class="ruby-value">:out</span>, <span class="ruby-value">:err</span>]] = <span class="ruby-identifier">out_w</span>

  <span class="ruby-identifier">popen_run</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">out_w</span>], [<span class="ruby-identifier">in_w</span>, <span class="ruby-identifier">out_r</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">ensure</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
    <span class="ruby-identifier">in_r</span>.<span class="ruby-identifier">close</span>
    <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">close</span>
    <span class="ruby-identifier">out_r</span>.<span class="ruby-identifier">close</span>
    <span class="ruby-identifier">out_w</span>.<span class="ruby-identifier">close</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-popen3" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-callseq">
              popen3([env, ] command_line, options = {}) &rarr; [stdin, stdout, stderr, wait_thread]
            </span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen3([env, ] exe_path, *args, options = {}) &rarr; [stdin, stdout, stderr, wait_thread]
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen3([env, ] command_line, options = {}) {|stdin, stdout, stderr, wait_thread| ... } &rarr; object
            </span>
          </div>
          <div class="method-heading">
            <span class="method-callseq">
              popen3([env, ] exe_path, *args, options = {}) {|stdin, stdout, stderr, wait_thread| ... } &rarr; object
            </span>
          </div>
        </div>

        <div class="method-description">
          <p>Basically a wrapper for <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> that:</p>
<ul><li>
<p>Creates a child process, by calling <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a> with the given arguments.</p>
</li><li>
<p>Creates streams <code>stdin</code>, <code>stdout</code>, and <code>stderr</code>, which are the standard input, standard output, and standard error streams in the child process.</p>
</li><li>
<p>Creates thread <code>wait_thread</code> that waits for the child process to exit; the thread has method <code>pid</code>, which returns the process ID of the child process.</p>
</li></ul>

<p>With no block given, returns the array <code>[stdin, stdout, stderr, wait_thread]</code>. The caller should close each of the three returned streams.</p>

<pre class="ruby"><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">stderr</span>, <span class="ruby-identifier">wait_thread</span> = <span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo&#39;</span>)
<span class="ruby-comment"># =&gt; [#&lt;IO:fd 8&gt;, #&lt;IO:fd 10&gt;, #&lt;IO:fd 12&gt;, #&lt;Process::Waiter:0x00007f58d5428f58 run&gt;]</span>
<span class="ruby-identifier">stdin</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">stdout</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">stderr</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>   <span class="ruby-comment"># =&gt; 2210481</span>
<span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span> <span class="ruby-comment"># =&gt; #&lt;Process::Status: pid 2210481 exit 0&gt;</span>
</pre>

<p>With a block given, calls the block with the four variables (three streams and the wait thread) and returns the block’s return value. The caller need not close the streams:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">stdin</span>, <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">stderr</span>, <span class="ruby-identifier">wait_thread</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdin</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stdout</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">stderr</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">pid</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">wait_thread</span>.<span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Output:</p>

<pre class="ruby"><span class="ruby-comment">#&lt;IO:fd 6&gt;</span>
<span class="ruby-comment">#&lt;IO:fd 7&gt;</span>
<span class="ruby-comment">#&lt;IO:fd 9&gt;</span>
<span class="ruby-comment">#&lt;Process::Waiter:0x00007f58d53606e8 sleep&gt;</span>
<span class="ruby-value">2211047</span>
<span class="ruby-comment">#&lt;Process::Status: pid 2211047 exit 0&gt;</span>
</pre>

<p>Like <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method has potential security vulnerabilities if called with untrusted input; see <a href="command_injection_rdoc.html#label-Command+Injection">Command Injection</a>.</p>

<p>Unlike <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>, this method waits for the child process to exit before returning, so the caller need not do so.</p>

<p>If the first argument is a hash, it becomes leading argument <code>env</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Environment">Execution Environment</a>.</p>

<p>If the last argument is a hash, it becomes trailing argument <code>options</code> in the call to <a href="Process.html#method-c-spawn"><code>Process.spawn</code></a>; see <a href="Process.html#module-Process-label-Execution+Options">Execution Options</a>.</p>

<p>The single required argument is one of the following:</p>
<ul><li>
<p><code>command_line</code> if it is a string, and if it begins with a shell reserved word or special built-in, or if it contains one or more metacharacters.</p>
</li><li>
<p><code>exe_path</code> otherwise.</p>
</li></ul>

<p><strong>Argument <code>command_line</code></strong></p>

<p>String argument <code>command_line</code> is a command line to be passed to a shell; it must begin with a shell reserved word, begin with a special built-in, or contain meta characters:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;if true; then echo &quot;Foo&quot;; fi&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> } <span class="ruby-comment"># Shell reserved word.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }                         <span class="ruby-comment"># Built-in.</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;date &gt; date.tmp&#39;</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">args</span> }              <span class="ruby-comment"># Contains meta character.</span>
</pre>

<p>Output (similar for each call above):</p>

<pre>[#&lt;IO:(closed)&gt;, #&lt;IO:(closed)&gt;, #&lt;IO:(closed)&gt;, #&lt;Process::Waiter:0x00007f58d52f28c8 dead&gt;]</pre>

<p>The command line may also contain arguments and options for the command:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo &quot;Foo&quot;&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-string">&quot;Foo\n&quot;</span>
</pre>

<p><strong>Argument <code>exe_path</code></strong></p>

<p>Argument <code>exe_path</code> is one of the following:</p>
<ul><li>
<p>The string path to an executable to be called.</p>
</li><li>
<p>A 2-element array containing the path to an executable and the string to be used as the name of the executing process.</p>
</li></ul>

<p>Example:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;/usr/bin/date&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;Wed Sep 27 02:56:44 PM CDT 2023\n&quot;</span>
</pre>

<p>Ruby invokes the executable directly, with no shell and no shell expansion:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;doesnt_exist&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> } <span class="ruby-comment"># Raises Errno::ENOENT</span>
</pre>

<p>If one or more <code>args</code> is given, each is an argument or option to be passed to the executable:</p>

<pre class="ruby"><span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;C #&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;C #\n&quot;</span>
<span class="ruby-constant">Open3</span>.<span class="ruby-identifier">popen3</span>(<span class="ruby-string">&#39;echo&#39;</span>, <span class="ruby-string">&#39;hello&#39;</span>, <span class="ruby-string">&#39;world&#39;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">e</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-comment"># =&gt; &quot;hello world\n&quot;</span>
</pre>

<p>Take care to avoid deadlocks. Output streams <code>stdout</code> and <code>stderr</code> have fixed-size buffers, so reading extensively from one but not the other can cause a deadlock when the unread buffer fills. To avoid that, <code>stdout</code> and <code>stderr</code> should be read simultaneously (using threads or <a href="IO.html#method-c-select"><code>IO.select</code></a>).</p>

<p>Related:</p>
<ul><li>
<p><a href="Open3.html#method-c-popen2"><code>Open3.popen2</code></a>: Makes the standard input and standard output streams of the child process available as separate streams, with no access to the standard error stream.</p>
</li><li>
<p><a href="Open3.html#method-c-popen2e"><code>Open3.popen2e</code></a>: Makes the standard input and the merge of the standard output and standard error streams of the child process available as separate streams.</p>
</li></ul>

          <div class="method-source-code" id="popen3-source">
            <pre><span class="ruby-comment"># File lib/open3.rb, line 218</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">popen3</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">opts</span> = {}
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">in_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:in</span>] = <span class="ruby-identifier">in_r</span>
  <span class="ruby-identifier">in_w</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">out_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:out</span>] = <span class="ruby-identifier">out_w</span>

  <span class="ruby-identifier">err_r</span>, <span class="ruby-identifier">err_w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:err</span>] = <span class="ruby-identifier">err_w</span>

  <span class="ruby-identifier">popen_run</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">opts</span>, [<span class="ruby-identifier">in_r</span>, <span class="ruby-identifier">out_w</span>, <span class="ruby-identifier">err_w</span>], [<span class="ruby-identifier">in_w</span>, <span class="ruby-identifier">out_r</span>, <span class="ruby-identifier">err_r</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

    </section>

  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.6.3.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

